/**
 * TeeTimeGrabber.java
 * 
 * command line utility for grabbing tee times.  See TeeTime.java for a GUI based interface.
 * 
 */
	
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.logging.Level;
import java.util.logging.Logger;

import zero.util.net.HTTPRequest;


public class TeeTimeGrabber {

	/**
	 * @param args
	 */
	public static void main(String[] args) {

		boolean retry = true;
		
		Logger logger = Logger.getLogger("zero.util.net");
		logger.setLevel( Level.ALL ) ;
		
		teetime.Session session = new teetime.Session("https://www.prestonwood.com");
		session.setCoursePreferences(new teetime.CoursePreferences(teetime.CoursePreferences.HIGHLANDS | teetime.CoursePreferences.MEADOWS));
		
		if (session.login( "djboulia", "tig1ger")) {
//		if (session.login( "kboulia", "maybelle9036")) {

			try {
		        DateFormat formatter = new SimpleDateFormat("h:mm a MM/dd/yyyy");
				Date theDate = formatter.parse( "8:00 AM 10/16/2011" );
				
				do {
					if (session.reserve( theDate ) != null) {
						System.out.println("Got the reservation!");
						retry = false;
					} else {
						if (retry) {
							System.out.println("No times available, retrying...");
						} else {
							System.out.println("No times available!");
						}
					}
				} while (retry);
				
			} catch( Exception e ) {
				e.printStackTrace();
			}
			
			session.logout();
		}
		
	}

}
